/*!
 * jquery.simpleFilePreview v0.1.0 (https://github.com/jakerella/jquerySimpleFilePreview)
 * Copyright (c) 2012 Jordan Kasper
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 */
!function(a){"use strict";a.fn.simpleFilePreview=function(g){if(!this||!this.length)return this;if(g=g?g:{},g=a.extend({},a.simpleFilePreview.defaults,g),this.each(function(){c(a(this),g)}),a.simpleFilePreview.init)return this;var h=a("body");return a.simpleFilePreview.init=!0,h.on("click",".simpleFilePreview_input",function(b){a(this).closest(".simpleFilePreview").find("input.simpleFilePreview_formInput").trigger("click"),b.preventDefault()}),h.on("click",".simpleFilePreview input.simpleFilePreview_formInput",function(b){return a(this).val().length?(a(this).closest(".simpleFilePreview").find(".simpleFilePreview_preview").trigger("click"),void b.preventDefault()):this}),h.on("change",".simpleFilePreview input.simpleFilePreview_formInput",function(b){var c=a(this).closest(".simpleFilePreview");if(1==c.attr("data-sfpallowmultiple")&&!c.find(".simpleFilePreview_preview").length){var h=a.simpleFilePreview.uid++,i=c.clone(!0).attr("id","simpleFilePreview_"+h);i.find("input.simpleFilePreview_formInput").attr("id",i.find("input.simpleFilePreview_formInput").attr("id")+"_"+h).val(""),c.after(i);var j=c.closest(".simpleFilePreview_multi").width("+="+i.outerWidth(!0)).width();j>c.closest(".simpleFilePreview_multiClip").width()&&c.closest(".simpleFilePreview_multiUI").find(".simpleFilePreview_shiftRight").trigger("click")}if(this.files&&this.files[0]){var k=new RegExp("^image/("+a.simpleFilePreview.previewFileTypes+")$");if(k.test(this.files[0].type.toLowerCase())&&window.FileReader){var l=new FileReader;l.onload=function(a){d(c,a.target.result,"",g)},l.readAsDataURL(this.files[0])}else{var m=this.files[0].type.toLowerCase().match(/^\s*[^\/]+\/([a-zA-Z0-9\-\.]+)\s*$/);m&&m[1]&&g.icons[m[1]]?d(c,g.icons[m[1]],e(this.value),g):d(c,g.defaultIcon,e(this.value),g)}return this}var k=new RegExp("^("+a.simpleFilePreview.previewFileTypes+")$"),n=f(this.value);n=n?n.toLowerCase():null,n&&!/fakepath/.test(this.value.toLowerCase())&&k.test(b)?d(c,"file://"+this.value,"",g):g.icons[n]?d(c,g.icons[n],e(this.value),g):d(c,g.defaultIcon,e(this.value),g)}),h.on("mouseover",".simpleFilePreview_preview, .simpleFilePreview input.simpleFilePreview_formInput",function(){var b=a(this).closest(".simpleFilePreview");b.find(".simpleFilePreview_preview").is(":visible")&&b.find(".simpleFilePreview_remove").show()}),h.on("mouseout",".simpleFilePreview_preview, .simpleFilePreview input.simpleFilePreview_formInput",function(){a(this).closest(".simpleFilePreview").find(".simpleFilePreview_remove").hide()}),h.on("click",".simpleFilePreview_preview",function(){var c=a(this),d=c.closest(".simpleFilePreview");if(1==d.attr("data-sfpallowmultiple")&&d.siblings(".simpleFilePreview").length)return d.hasClass("simpleFilePreview_existing")&&d.parent().append("<input type='hidden' id='"+d.attr("id")+"_remove' name='removeFiles[]' value='"+d.attr("data-sfprid")+"' />"),b(c,g,1),d.closest(".simpleFilePreview_multi").width("-="+d.width()),d.remove(),this;d.hasClass("simpleFilePreview_existing")&&(d.find("input.simpleFilePreview_formInput").show(),d.append("<input type='hidden' id='"+d.attr("id")+"_remove' name='removeFiles[]' value='"+d.attr("data-sfprid")+"' />"),d.removeClass("simpleFilePreview_existing")),b(c,g,1);var e=d.find("input.simpleFilePreview_formInput").val("");if(e&&e.length&&e.val().length){for(var f=e.get(0).attributes,h="",i=0,j=f.length;i<j;++i)"value"!=f[i].name&&"title"!=f[i].name&&(h+=f[i].name+"='"+e.attr(f[i].name)+"' ");e.before('<input "'+h+'" />'),e.remove()}c.remove(),d.find(".simpleFilePreview_filename").remove(),d.find(".simpleFilePreview_remove").hide().end().find(".simpleFilePreview_input").show()}),h.on("click",".simpleFilePreview_shiftRight",function(){var b=a(this).closest(".simpleFilePreview_multiUI").find(".simpleFilePreview_multi"),c=parseInt(b.css("left"))+b.width();if(c>b.parent().width()){var d=b.find("li:first");b.animate({left:"-="+d.outerWidth(!0)})}}),h.on("click",".simpleFilePreview_shiftLeft",function(){var b=a(this).closest(".simpleFilePreview_multiUI").find(".simpleFilePreview_multi"),c=parseInt(b.css("left"));if(c<0){var d=b.find("li:first").outerWidth(!0);b.animate({left:c+d<1?"+="+d:0})}}),this};var b=function(a,b,c){if(!b.limit)return!1;var d=a.closest(".simpleFilePreview_multi").find("> li");c=c?c:0,d.length>b.limit+c?d.last().hide():d.last().show()},c=function(b,c){var g=b.is("[multiple]");b=b.removeAttr("multiple").addClass("simpleFilePreview_formInput");var h=a("<"+(g?"li":"div")+" id='simpleFilePreview_"+a.simpleFilePreview.uid++ +"' class='simpleFilePreview' data-sfpallowmultiple='"+(g?1:0)+"'><a class='simpleFilePreview_input'><span class='simpleFilePreview_inputButtonText'>"+c.buttonContent+"</span></a><span class='simpleFilePreview_remove'>"+c.removeContent+"</span></"+(g?"li":"div")+">");b.before(h),h.append(b),b.css({width:h.width()+"px",height:h.height()+"px"}),g&&(h.wrap("<div class='simpleFilePreview_multiUI'><div class='simpleFilePreview_multiClip'><ul class='simpleFilePreview_multi'></ul></div></div>"),h.closest(".simpleFilePreview_multiUI").prepend("<span class='simpleFilePreview_shiftRight simpleFilePreview_shifter'>"+c.shiftRight+"</span>").append("<span class='simpleFilePreview_shiftLeft simpleFilePreview_shifter'>"+c.shiftLeft+"</span>"));var i=c.existingFiles;if(!i)return g&&a(".simpleFilePreview_multi").width(h.outerWidth(!0)*h.parent().find(".simpleFilePreview").length),b;var j=new RegExp("^("+a.simpleFilePreview.previewFileTypes+")$");if(g){var k=a.isArray(i)?1:0;for(var l in i){var m=a.simpleFilePreview.uid++,n=h.clone(!0).attr("id","simpleFilePreview_"+m);n.addClass("simpleFilePreview_existing").attr("data-sfprid",k?i[l]:l).find("input.simpleFilePreview_formInput").remove(),h.before(n);var o=f(i[l]);o=o?o.toLowerCase():null,o&&j.test(o)?d(n,i[l],"",c):c.icons[o]?d(n,c.icons[o],e(i[l]),c):d(n,c.defaultIcon,e(i[l]),c)}return a(".simpleFilePreview_multi").width(h.outerWidth(!0)*h.parent().find(".simpleFilePreview").length),b}var p=null,k=a.isArray(i)?1:0;for(var l in i)p={id:k?i[l]:l,file:i[l]};if(!p)return b;h.attr("data-sfprid",p.id).addClass("simpleFilePreview_existing").find("input.simpleFilePreview_formInput").hide();var o=f(p.file);return o=o?o.toLowerCase():null,o&&j.test(o)?d(h,p.file,"",c):c.icons[o]?d(h,c.icons[o],e(p.file),c):d(h,c.defaultIcon,e(p.file),c),b},d=function(a,c,d,e){d=d?d:null,c=(new RegExp("[/\\\\]").test(c)?"":e.iconPath)+c,a.find(".simpleFilePreview_input").hide();var f=a.find(".simpleFilePreview_preview");if(f&&f.length?f.attr("src",c):(a.append("<img src='"+c+"' class='simpleFilePreview_preview "+(d?"simpleFilePreview_hasFilename":"")+"' alt='"+(d?d:"File Preview")+"' title='Remove "+(d?d:"this file")+"' />"),a.find("input.simpleFilePreview_formInput").attr("title","Remove "+(d?d:"this file"))),b(a,e),!d)return null;var g=a.find(".simpleFilePreview_filename");g&&g.length?g.text(d):a.append("<span class='simpleFilePreview_filename'>"+d+"</span>").find(".simpleFilePreview_filename")},e=function(a){var b=a.match(/[\/\\]([^\/\\]+)$/);return b&&b[1]&&b[1].length?b[1]:null},f=function(a){var b=a.match(/[\.]([^\/\\\.]+)$/);return b&&b[1]&&b[1].length?b[1]:null};a.simpleFilePreview={defaults:{buttonContent:"Add File",removeContent:"X",existingFiles:null,shiftLeft:"&lt;&lt;",shiftRight:"&gt;&gt;",iconPath:"",defaultIcon:"preview_file.png",limit:0,icons:{png:"preview_png.png",gif:"preview_png.png",bmp:"preview_png.png",svg:"preview_png.png",jpg:"preview_png.png",jpeg:"preview_png.png",pjpg:"preview_png.png",pjpeg:"preview_png.png",tif:"preview_png.png",tiff:"preview_png.png",mp3:"preview_mp3.png",mp4:"preview_mp3.png",wav:"preview_mp3.png",wma:"preview_mp3.png",pdf:"preview_pdf.png",txt:"preview_txt.png",rtf:"preview_txt.png",text:"preview_txt.png",plain:"preview_txt.png",zip:"preview_zip.png",tgz:"preview_zip.png","x-rar-compressed":"preview_zip.png","octet-stream":"preview_zip.png",odf:"preview_doc.png",odt:"preview_doc.png",doc:"preview_doc.png",msword:"preview_doc.png","vnd.openxmlformats-officedocument.wordprocessingml.document":"preview_doc.png",docx:"preview_doc.png",ods:"preview_xls.png","vnd.ms-excel":"preview_xls.png",xls:"preview_xls.png",xlx:"preview_xls.png",msexcel:"preview_xls.png","x-excel":"preview_xls.png","x-ms-excel":"preview_xls.png","vnd.openxmlformats-officedocument.spreadsheetml.sheet":"preview_xls.png"}},uid:0,init:!1,previewFileTypes:"p?jpe?g|png|gif|bmp|svg"}}(jQuery);